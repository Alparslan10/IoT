<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ESP32 LED Kontrol</title>
</head>
<body>
  <h1>LED Kontrol Paneli</h1>
  <button onclick="toggleLED()">LED Aç/Kapat</button>
  <p>LED Durumu: <span id="ledStatus">Bilinmiyor</span></p>

  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
  <script>
    const options = {
      protocol: "wss",
      hostname: "192.168.195.222",
      port: 9002,
      path: "/mqtt",
      rejectUnauthorized: false // self-signed sertifika için
    };

    const client = mqtt.connect(options);

    client.on('connect', function () {
      console.log("Bağlandı!");
      client.subscribe("esp32/led/state");
    });

    client.on('message', function (topic, message) {
      if (topic === "esp32/led/state") {
        document.getElementById("ledStatus").innerText = message.toString();
      }
    });

    function toggleLED() {
      client.publish("esp32/led/control", "toggle");
    }
  </script>
</body>
</html>
